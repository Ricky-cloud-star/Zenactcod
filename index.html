<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>å°é¢éªŒè¯</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
        }

        .coverContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #b8860b, #000000);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .coverContent {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .coverContent input {
            padding: 12px;
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 16px;
            width: 80%;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        .coverContent button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
        }

        .coverTitle {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }
    </style>
</head>
<body>
    <!-- å°é¢æ¨¡å— -->
    <div class="coverContainer" id="coverContainer">
        <div class="coverContent">
            <div class="coverTitle">æ¬¢è¿æ¥åˆ°Rickyçš„å·¥å…·ç®±</div>
            <h2>ä½ æ˜¯è°ï¼Ÿ</h2>
            <input type="text" id="identityInput" placeholder="è¾“å…¥æ‚¨çš„åå­—">
            <br>
            <button onclick="checkIdentity()">æäº¤</button>
            <div id="errorMessage" style="color: red; margin-top: 10px;"></div>
        </div>
    </div>

    <script>
        // å°é¢é—®é¢˜éªŒè¯åŠŸèƒ½
        function checkIdentity() {
            const identity = document.getElementById('identityInput').value.trim();
            const validIdentities = ["Nala", "Lucy"]; // è®¾ç½®å…è®¸çš„ç­”æ¡ˆ

            if (validIdentities.includes(identity)) {
                document.getElementById('coverContainer').style.display = 'none';
            } else {
                document.getElementById('errorMessage').textContent = 'å›ç­”é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚';
            }
        }
    </script>
</body>
</html>

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº“å­˜æ•°æ®å¤„ç†å™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            margin-top: 20px;
            position: relative;
        }

        .leftPanel {
            flex: 3;
            margin-right: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .fileContainer {
            text-align: center;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .buttons {
            margin-top: 20px;
            text-align: center;
        }

        #dropArea {
            width: 80%;
            height: 100px;
            border: 2px dashed #aaa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            color: #888;
            transition: border-color 0.3s, color 0.3s;
        }
        #dropArea.dragover {
            border-color: #00aaff;
            color: #00aaff;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            position: relative;
        }

        th {
            background-color: #bca87e;
            color: #000000;
            font-size: 12px;
        }

        .rightPanel {
            width: 280px;
            height: auto;
            border: 2px solid #d4af37;
            padding: 10px;
            background-color: #fff8e1;
            position: absolute;
            top: 20px;
            right: 20px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .file-label {
            margin-bottom: 10px;
            display: block;
            text-align: center;
            color: #555;
            font-size: 14px;
        }

        #csvFileInput {
            display: none;
        }

        .file-label i {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="leftPanel">
            <h1 class="header">åº“å­˜æ•°æ®å¤„ç†å™¨</h1>
            <div class="fileContainer">
                <label for="csvFileInput" class="file-label"><i class="fas fa-file-upload"></i> Select a CSV file or drag and drop below</label>
                <input type="file" id="csvFileInput" accept=".csv" />
            </div>
            <div id="dropArea">Drag and drop your CSV file here</div>
            <div class="buttons">
                <button onclick="convertToXLSM()">Convert to XLSM</button>
            </div>
        </div>
        <div class="rightPanel">
            <h3>æŸ¥è¯¢ç»“æœ</h3>
            <div id="rowPosition1">è¯·å…ˆé€‰æ‹©æ–‡ä»¶ã€‚</div>
        </div>
    </div>

    <script>
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('csvFileInput');
        let csvFile;

        dropArea.addEventListener('dragover', (event) => {
            event.preventDefault();
            dropArea.classList.add('dragover');
        });

        dropArea.addEventListener('dragleave', () => {
            dropArea.classList.remove('dragover');
        });

        dropArea.addEventListener('drop', (event) => {
            event.preventDefault();
            dropArea.classList.remove('dragover');
            csvFile = event.dataTransfer.files[0];
            if (csvFile && csvFile.type === 'text/csv') {
                dropArea.textContent = `File ready: ${csvFile.name}`;
                document.getElementById('rowPosition1').textContent = `å·²é€‰æ‹©æ–‡ä»¶ï¼š${csvFile.name}`;
            } else {
                alert('Please drop a valid CSV file.');
            }
        });

        fileInput.addEventListener('change', (event) => {
            csvFile = event.target.files[0];
            if (csvFile && csvFile.type === 'text/csv') {
                dropArea.textContent = `File ready: ${csvFile.name}`;
                document.getElementById('rowPosition1').textContent = `å·²é€‰æ‹©æ–‡ä»¶ï¼š${csvFile.name}`;
            } else {
                alert('Please select a valid CSV file.');
            }
        });

        function convertToXLSM() {
            if (!csvFile) {
                alert("Please upload or drop a CSV file first.");
                return;
            }

            // ä½¿ç”¨FileReaderæ¥è¯»å–æ–‡ä»¶
            const reader = new FileReader();
            reader.onload = function(event) {
                const csvData = event.target.result;

                // ä½¿ç”¨SheetJSè¯»å–CSVæ•°æ®
                const workbook = XLSX.read(csvData, { type: 'string' });

                // åˆ›å»ºæ–°çš„å·¥ä½œç°¿å¹¶æ·»åŠ å·¥ä½œè¡¨
                const newWorkbook = XLSX.utils.book_new();
                let worksheet = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]], { header: 1 });

                // 1. å»é™¤æ‰€æœ‰å•å…ƒæ ¼ä¸­çš„å‰åç©ºæ ¼
                worksheet = worksheet.map(row => row.map(cell => (typeof cell === 'string' ? cell.trim() : cell)));

                // 2. åœ¨ç¬¬13è¡Œæ‰¾åˆ°"Item Number"ï¼Œåœ¨ç¬¬14è¡Œæ‰¾åˆ°"Location/Lot"
                let itemNumberCol = -1;
                let locationLotCol = -1;
                worksheet[12].forEach((cell, index) => {
                    if (cell === "Item Number") {
                        itemNumberCol = index;
                    }
                });
                worksheet[13].forEach((cell, index) => {
                    if (cell === "Location/Lot") {
                        locationLotCol = index;
                    }
                });

                // 3. å°†ç¬¬14è¡Œä¸­çš„"Location/Lot"å¾€å³ç§»åŠ¨ä¸€ä¸ªå•å…ƒæ ¼ï¼Œå°†ç¬¬13è¡Œä¸­çš„"Item Number"å¾€ä¸‹ç§»åŠ¨è‡³ç¬¬14è¡Œ
                if (locationLotCol !== -1) {
                    worksheet[13].splice(locationLotCol + 1, 0, worksheet[13][locationLotCol]);
                    worksheet[13][locationLotCol] = "Location/Lot"; // ä¿ç•™"Location/Lot"æ ‡é¢˜
                }
                if (itemNumberCol !== -1) {
                    worksheet[13][itemNumberCol] = worksheet[12][itemNumberCol];
                    worksheet[12][itemNumberCol] = "";
                }

                // 4. æ ¹æ®ç¬¬14è¡Œ"Item Number"çš„ä½ç½®ï¼Œåˆ é™¤ä¸Šæ–¹çš„æ‰€æœ‰è¡Œå’Œå·¦ä¾§çš„æ‰€æœ‰åˆ—
                if (itemNumberCol !== -1) {
                    worksheet = worksheet.slice(13); // åˆ é™¤ä¸Šæ–¹çš„æ‰€æœ‰è¡Œ
                    worksheet = worksheet.map(row => row.slice(itemNumberCol)); // åˆ é™¤å·¦ä¾§çš„æ‰€æœ‰åˆ—
                }

                // 5. å®šä½åˆ°B2å•å…ƒæ ¼ï¼Œåˆ é™¤è¿™ä¸ªå•å…ƒæ ¼ï¼Œå°†ä¸‹æ–¹å•å…ƒæ ¼ä¸Šç§»
                if (worksheet.length > 1 && worksheet[1].length > 1) {
                    for (let i = 1; i < worksheet.length - 1; i++) {
                        worksheet[i][1] = worksheet[i + 1][1];
                    }
                    worksheet[worksheet.length - 1][1] = ""; // æœ€åä¸€è¡Œç½®ä¸ºç©º
                }

                // 6. ç­›é€‰Båˆ—ï¼Œé€‰æ‹©æ‰€æœ‰ç©ºç™½è¡Œï¼Œå°†Båˆ—ä¸­ç©ºç™½å•å…ƒæ ¼æ‰€åœ¨è¡Œå…¨éƒ¨åˆ é™¤
                worksheet = worksheet.filter((row, rowIndex) => {
                    if (rowIndex === 0) return true; // ä¿ç•™æ ‡é¢˜è¡Œ
                    return row[1] && row[1].toString().trim() !== ""; // åˆ é™¤Båˆ—ä¸ºç©ºçš„è¡Œ
                });

                // 7. å°†Cåˆ—å’ŒEåˆ—åˆ é™¤
                worksheet = worksheet.map(row => row.filter((_, colIndex) => colIndex !== 2 && colIndex !== 4));

                // 8. å®šä½åˆ°D1ï¼Œå°†å…¶ç§»åŠ¨è‡³C1; å®šä½åˆ°F1ï¼Œå°†å…¶ç§»åŠ¨åˆ°E1
                if (worksheet.length > 0) {
                    if (worksheet[0].length > 3) {
                        worksheet[0][2] = worksheet[0][3];
                        worksheet[0][3] = "";
                    }
                    if (worksheet[0].length > 5) {
                        worksheet[0][4] = worksheet[0][5];
                        worksheet[0][5] = "";
                    }
                }

                // 9. åˆ é™¤Dåˆ—
                worksheet = worksheet.map(row => row.filter((_, colIndex) => colIndex !== 3));

                // 10. å®šä½åˆ°F1ï¼Œå°†å…¶ç§»åŠ¨åˆ°E1; å®šä½åˆ°H1ï¼Œå°†å…¶ç§»åŠ¨åˆ°G1
                if (worksheet.length > 0) {
                    if (worksheet[0].length > 4) {
                        worksheet[0][4] = worksheet[0][5];
                        worksheet[0][5] = "";
                    }
                    if (worksheet[0].length > 6) {
                        worksheet[0][6] = worksheet[0][7];
                        worksheet[0][7] = "";
                    }
                }

                // 11. åˆ é™¤F, H, Iåˆ—
                worksheet = worksheet.map(row => row.filter((_, colIndex) => colIndex !== 5 && colIndex !== 7 && colIndex !== 8));

                // 12. å®šä½åˆ°J1ï¼Œå°†å…¶ç§»åŠ¨åˆ°I1; å®šä½åˆ°L1ï¼Œå°†å…¶ç§»åŠ¨åˆ°K1
                if (worksheet.length > 0) {
                    if (worksheet[0].length > 8) {
                        worksheet[0][8] = worksheet[0][9];
                        worksheet[0][9] = "";
                    }
                    if (worksheet[0].length > 10) {
                        worksheet[0][10] = worksheet[0][11];
                        worksheet[0][11] = "";
                    }
                }

                // 13. åˆ é™¤Håˆ—å’ŒJåˆ—
                worksheet = worksheet.map(row => row.filter((_, colIndex) => colIndex !== 7 && colIndex !== 9));

                // å°†ä¿®æ”¹åçš„æ•°æ®æ·»åŠ åˆ°æ–°çš„å·¥ä½œç°¿ä¸­
                const newWorksheet = XLSX.utils.aoa_to_sheet(worksheet);
                XLSX.utils.book_append_sheet(newWorkbook, newWorksheet, "Sheet1");

                // è®¾ç½®å†™å…¥é€‰é¡¹ï¼Œä¿å­˜ä¸ºxlsmæ ¼å¼
                const writeOptions = {
                    bookType: 'xlsm',
                    bookSST: false,
                    type: 'binary'
                };
                const wbout = XLSX.write(newWorkbook, writeOptions);

                // å°†å†…å®¹è½¬æ¢ä¸ºblob
                function s2ab(s) {
                    const buf = new ArrayBuffer(s.length);
                    const view = new Uint8Array(buf);
                    for (let i = 0; i < s.length; i++) {
                        view[i] = s.charCodeAt(i) & 0xFF;
                    }
                    return buf;
                }

                // åˆ›å»ºblobå¯¹è±¡å¹¶ä¸‹è½½
                const blob = new Blob([s2ab(wbout)], { type: "application/vnd.ms-excel.sheet.macroEnabled.12" });
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = "output.xlsm";
                link.click();

                document.getElementById('rowPosition1').textContent = `æ–‡ä»¶å·²å¯¼å‡ºè‡³ï¼š${link.download}`;
            };
            
            // è¯»å–æ–‡ä»¶ä¸ºæ–‡æœ¬å­—ç¬¦ä¸²
            reader.readAsText(csvFile);
        }
    </script>
</body>
</html>

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>DTS Software Licensing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            margin-top: 20px;
            position: relative;
        }

        .leftPanel {
            flex: 3;
            margin-right: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .fileContainer {
            text-align: left;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .searchContainer {
            margin-bottom: 20px;
            text-align: left;
            margin-top: 10px;
        }

        #resultTable1 {
            width: 100%;
            margin-top: 20px;
        }

        .resultTable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            position: relative;
        }

        th {
            background-color: #bca87e;
            color: #000000;
            font-size: 12px;
        }

        .rightPanel {
            width: 320px;
            height: auto;
            border: 2px solid #d4af37;
            padding: 15px;
            background-color: #fff8e1;
            position: absolute;
            top: 20px;
            right: 20px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .copyIcon {
            position: absolute;
            top: 50%;
            right: 5px;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 14px;
            color: #d4af37;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- ç¬¬ä¸€ä¸ªæ¨¡å— -->
    <div class="container" id="container1">
        <div class="leftPanel">
            <h1 class="header">DTS Software Licensing</h1>

            <!-- é€‰æ‹©æ–‡ä»¶æŒ‰é’® -->
            <div class="fileContainer">
                <input type="file" id="fileInput1" accept=".xlsx, .xlsm, .xls" />
            </div>

            <!-- è¾“å…¥æ¡†å’Œæœç´¢æŒ‰é’® -->
            <div class="searchContainer">
                <input type="text" class="jdeOrderNumber" id="jdeOrderNumber1" placeholder="Enter JDE Order Number">
                <button class="searchButton" onclick="handleSearch1()">Search</button>
                <button class="clearButton" onclick="clearResults1()">Clear</button>
                
                <input type="text" id="githubTokenInput" placeholder="Enter GitHub Token" style="margin-left: 10px;">
                <button class="cloudSearchButton" onclick="handleCloudSearch1()">ä»äº‘ç«¯æœç´¢æ•°æ®</button>
            </div>

            <!-- é€‰æ‹©æ•°æ®éªŒè¯æ–‡ä»¶æŒ‰é’® -->
            <div class="fileContainer">
                <input type="file" id="validationFileInput" accept=".csv, .xlsx, .xlsm, .xls" />
                <button class="validateButton" onclick="handleValidation()">æŸ¥éªŒæ•°æ®</button>
                <button class="validateButton2" onclick="handleValidation2()">æŸ¥éªŒæ•°æ®2</button>
            </div>

            <!-- è¡¨æ ¼æ˜¾ç¤ºåŒºåŸŸ -->
            <div id="contentPreview1">
                <table class="resultTable" id="resultTable1">
                    <thead>
                        <tr>
                            <th>JDE Order Type</th>
                            <th>JDE Order Number</th>
                            <th>Shipping Contact: First Name</th>
                            <th>Shipping Contact: Last Name</th>
                            <th>Shipping Contact: Email</th>
                            <th>Company to ship: JDE Address Number</th>
                            <th>Company to ship: Account Name</th>
                        </tr>
                    </thead>
                    <tbody id="resultBody1"></tbody>
                </table>
            </div>
        </div>
        <div class="rightPanel">
            <h3>æŸ¥è¯¢ç»“æœ</h3>
            <div id="rowPosition1">è¯·å…ˆé€‰æ‹©æ–‡ä»¶å¹¶è¾“å…¥JDEè®¢å•å·ã€‚</div>
        </div>
    </div>

    <script>
        // æ¨¡å—1çš„JavaScriptåŠŸèƒ½
        (function() {
            let workbook1;
            let validationWorkbook;

            document.getElementById('fileInput1').addEventListener('change', handleFile1);
            document.getElementById('validationFileInput').addEventListener('change', handleValidationFile);

            function handleFile1(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const data = new Uint8Array(e.target.result);
                        workbook1 = XLSX.read(data, { type: 'array' });
                        document.getElementById('rowPosition1').textContent = `å·²é€‰æ‹©æ–‡ä»¶ï¼š${file.name}`;
                    };
                    reader.readAsArrayBuffer(file);
                }
            }

            function handleValidationFile(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const data = new Uint8Array(e.target.result);
                        validationWorkbook = XLSX.read(data, { type: 'array' });
                        document.getElementById('rowPosition1').textContent = `å·²é€‰æ‹©éªŒè¯æ–‡ä»¶ï¼š${file.name}`;
                    };
                    reader.readAsArrayBuffer(file);
                }
            }

            async function handleCloudSearch1() {
                const githubToken = document.getElementById('githubTokenInput').value.trim();
                if (!githubToken) {
                    alert("ä»¤ç‰Œä¸èƒ½ä¸ºç©ºï¼");
                    return;
                }
                updateResponseBox("æ­£åœ¨ä»äº‘ç«¯è·å–æ•°æ®");

                const inputOrderNumbers = document.getElementById('jdeOrderNumber1').value.trim().split('&');
                const trimmedOrderNumbers = inputOrderNumbers.map(num => num.trim());
                try {
                    const repoOwner = 'Ricky-cloud-star';
                    const repoName = 'Mail-excel';
                    const filePath = 'data/data.csv';
                    const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;

                    const response = await fetch(url, {
                        method: 'GET',
                        headers: {
                            'Authorization': `token ${githubToken}`,
                            'Accept': 'application/vnd.github.v3.raw'
                        }
                    });

                    if (response.ok) {
                        const csvText = await response.text();
                        searchInCSV(csvText, trimmedOrderNumbers);
                        updateResponseBox('æ•°æ®å¯¼å…¥æˆåŠŸ');
                    } else {
                        const responseData = await response.json();
                        alert(`å¯¼å…¥å¤±è´¥ï¼š${responseData.message}`);
                        updateResponseBox('æ•°æ®å¯¼å…¥å¤±è´¥');
                    }
                } catch (error) {
                    alert(`å¯¼å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼š${error.message}`);
                    updateResponseBox('æ•°æ®å¯¼å…¥å¤±è´¥');
                }
            }

            function handleValidation2() {
                if (!validationWorkbook) {
                    alert("è¯·å…ˆé€‰æ‹©æ•°æ®éªŒè¯æ–‡ä»¶ã€‚");
                    return;
                }

                const validationSheet = validationWorkbook.Sheets['Sheet1'];
                if (!validationSheet) {
                    document.getElementById('rowPosition1').textContent = "æœªæ‰¾åˆ°Sheet1ã€‚";
                    return;
                }

                const validationData = XLSX.utils.sheet_to_json(validationSheet, { header: 1 });
                const orderReferenceIndex = validationData[0].indexOf("Order Reference ID");
                const customerAccountIndex = validationData[0].indexOf("Customer Account Reference ID");
                const customerIndex = validationData[0].indexOf("Customer");
                const validationOrders = validationData.slice(1);

                const displayedOrders = Array.from(document.querySelectorAll('#resultBody1 tr'));
                let resultMessage = "";

                displayedOrders.forEach(row => {
                    const jdeOrderNumber = row.querySelector('td:nth-child(2)').childNodes[0].textContent.trim();
                    const jdeAddressNumber = row.querySelector('td:nth-child(6)').childNodes[0].textContent.trim();
                    const accountName = row.querySelector('td:nth-child(7)').childNodes[0].textContent.trim();

                    const validationRow = validationOrders.find(order => order[orderReferenceIndex].toString().trim() === jdeOrderNumber);
                    if (validationRow) {
                        const expectedAddressNumber = validationRow[customerAccountIndex].toString().trim();
                        const expectedAccountName = validationRow[customerIndex].toString().trim();

                        if (jdeAddressNumber === expectedAddressNumber && accountName === expectedAccountName) {
                            resultMessage += `è®¢å•å· ${jdeOrderNumber} åŒ¹é…æ­£ç¡®ã€‚\n`;
                        } else {
                            if (jdeAddressNumber !== expectedAddressNumber) {
                                resultMessage += `è®¢å•å· ${jdeOrderNumber} çš„ JDE Address Number ä¸ä¸€è‡´ã€‚\n`;
                            }
                            if (accountName !== expectedAccountName) {
                                resultMessage += `è®¢å•å· ${jdeOrderNumber} çš„ Account Name ä¸ä¸€è‡´ã€‚\n`;
                            }
                        }
                    } else {
                        resultMessage += `è®¢å•å· ${jdeOrderNumber} åœ¨éªŒè¯æ–‡ä»¶ä¸­æœªæ‰¾åˆ°ã€‚\n`;
                    }
                });

                document.getElementById('rowPosition1').textContent = resultMessage || "æ•°æ®éªŒè¯é€šè¿‡ï¼Œæ‰€æœ‰è®¢å•å·åŒ¹é…ã€‚";
            }

            function searchInCSV(csvText, orderNumbers) {
                if (!csvText) {
                    alert('å¯¼å…¥çš„æ•°æ®ä¸ºç©ºï¼');
                    return;
                }

                const rows = csvText.trim().split("\n");
                const resultBody = document.getElementById('resultBody1');
                resultBody.innerHTML = '';

                let found = false;
                for (let i = 1; i < rows.length; i++) { // è·³è¿‡è¡¨å¤´
                    const rowArray = rows[i].split(",");
                    if (orderNumbers.includes(rowArray[1].replace('.0', '').toString())) {
                        const newRow = document.createElement('tr');
                        for (let j = 0; j < 7; j++) {
                            const cell = document.createElement('td');
                            cell.textContent = (rowArray[j] !== undefined && !isNaN(rowArray[j]) && rowArray[j] % 1 === 0) ? parseInt(rowArray[j]) : rowArray[j] !== undefined ? rowArray[j] : '';
                            if (j === 1 || j === 2 || j === 3 || j === 4 || j === 5 || j === 6) { // æ·»åŠ å¤åˆ¶å›¾æ ‡
                                const copyIcon = document.createElement('span');
                                copyIcon.className = 'copyIcon';
                                copyIcon.innerHTML = 'ğŸ“‹';
                                copyIcon.onclick = function() {
                                    copyCellContent(cell);
                                };
                                cell.appendChild(copyIcon);
                            }
                            newRow.appendChild(cell);
                        }
                        resultBody.appendChild(newRow);
                        found = true;
                    }
                }
                if (!found) {
                    document.getElementById('rowPosition1').textContent += "\næœªæ‰¾åˆ°è®¢å•æ•°æ®ã€‚";
                }
            }

            function handleValidation() {
                if (!validationWorkbook) {
                    alert("è¯·å…ˆé€‰æ‹©æ•°æ®éªŒè¯æ–‡ä»¶ã€‚");
                    return;
                }

                const validationSheet = validationWorkbook.Sheets['Sheet1'];
                if (!validationSheet) {
                    document.getElementById('rowPosition1').textContent = "æœªæ‰¾åˆ°Sheet1ã€‚";
                    return;
                }

                const validationData = XLSX.utils.sheet_to_json(validationSheet, { header: 1 });
                const orderReferenceIds = validationData.slice(1).map(row => row[validationData[0].indexOf("Order Reference ID")].toString().trim());

                const displayedOrderNumbers = Array.from(document.querySelectorAll('#resultBody1 tr td:nth-child(2)')).map(td => td.childNodes[0].textContent.trim());

                let missingInValidation = displayedOrderNumbers.filter(orderNumber => !orderReferenceIds.includes(orderNumber));
                let missingInDisplay = orderReferenceIds.filter(orderId => !displayedOrderNumbers.includes(orderId));

                let resultMessage = "";
                if (missingInValidation.length > 0) {
                    resultMessage += `åœ¨éªŒè¯æ–‡ä»¶ä¸­ç¼ºå°‘çš„è®¢å•å·: ${missingInValidation.join(", ")}\n`;
                }
                if (missingInDisplay.length > 0) {
                    resultMessage += `åœ¨ä¸‹æ–¹è¡¨æ ¼ä¸­ç¼ºå°‘çš„è®¢å•å·: ${missingInDisplay.join(", ")}`;
                }
                document.getElementById('rowPosition1').textContent = resultMessage || "æ•°æ®éªŒè¯é€šè¿‡ï¼Œæ‰€æœ‰è®¢å•å·åŒ¹é…ã€‚";
            }

            function clearResults1() {
                document.getElementById('resultBody1').innerHTML = '';
                document.getElementById('rowPosition1').textContent = 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶å¹¶è¾“å…¥JDEè®¢å•å·ã€‚';
                document.getElementById('jdeOrderNumber1').value = '';
            }

            function copyCellContent(cell) {
                const cellContent = cell.childNodes[0] ? cell.childNodes[0].textContent.trim() : cell.textContent.trim();
                if (cellContent === '') {
                    return;
                }

                const tempInput = document.createElement('textarea');
                tempInput.value = cellContent;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);

                document.getElementById('rowPosition1').textContent = "å·²å¤åˆ¶å†…å®¹: " + cellContent;
            }

            function updateResponseBox(message) {
                document.getElementById('rowPosition1').textContent = message;
            }

            window.handleSearch1 = handleCloudSearch1;
            window.clearResults1 = clearResults1;
            window.handleCloudSearch1 = handleCloudSearch1;
            window.handleValidation = handleValidation;
            window.handleValidation2 = handleValidation2;
        })();
    </script>
</body>
</html>

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Zenæ¿€æ´»ç è¾…åŠ©å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: flex;
            margin-top: 20px;
            position: relative;
        }

        .leftPanel {
            flex: 3;
            margin-right: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        #inputContainer {
            margin-top: 10px;
            margin-bottom: 10px;
            text-align: left;
        }

        #partNoInput, #addButton, #addButton2, #autoAddButton, #submitButton, #importButton, #fileSelectButton, #validateButton {
            padding: 8px;
            font-size: 14px;
            margin-right: 5px;
        }

        #addButton, #addButton2, #autoAddButton, #submitButton, #importButton, #fileSelectButton, #validateButton {
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        #addButton:hover, #addButton2:hover, #autoAddButton:hover, #submitButton:hover, #importButton:hover, #fileSelectButton:hover, #validateButton:hover {
            background-color: #45a049;
        }

        .deleteButton {
            padding: 5px 10px;
            font-size: 12px;
            margin-left: 5px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .deleteButton:hover {
            background-color: #d32f2f;
        }

        .deleteHeaderIcon {
            cursor: pointer;
            font-size: 18px;
            color: #f44336;
            margin-left: 10px;
        }

        .resultTable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            position: relative;
        }

        th {
            background-color: #607d8b;
            color: #fff;
            font-size: 12px;
        }

        #responseBox {
            width: 320px;
            height: auto;
            border: 2px solid #d4af37;
            padding: 15px;
            background-color: #fff8e1;
            position: absolute;
            top: 20px; /* å°†å“åº”çª—å£ä¸Šç§»ï¼Œä¸æ ‡é¢˜å¹³è¡Œ */
            right: 20px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        }

        #responseTitle {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
            color: #d4af37;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container" id="container2">
        <div class="leftPanel">
            <h1 class="header">Zenæ¿€æ´»ç è¾…åŠ©å·¥å…·</h1>

            <div id="inputContainer">
                <input type="text" id="partNoInput" placeholder="Enter SO">
                <button id="addButton" onclick="addNewRow()">æ–°å¢</button>
                <button id="addButton2" onclick="addNewHeader()">æ–°å¢2</button>
                <button id="autoAddButton" onclick="autoAddRows()">è‡ªåŠ¨æ–°å¢</button> <!-- æ–°å¢çš„è‡ªåŠ¨æ–°å¢æŒ‰é’® -->
                <button id="submitButton" onclick="submitDataToBackend()">æäº¤æ•°æ®</button>
                <button id="importButton" onclick="importDataFromGithub()">å¯¼å…¥æ•°æ®</button>
                <input type="file" id="fileInput" accept=".csv, .xlsx, .xlsm, .xls" style="margin-right: 5px;">
                <button id="validateButton" onclick="validateData()">æ•°æ®æ ¸éªŒ</button>
            </div>

            <div id="contentPreview2">
                <!-- è¡¨æ ¼æ˜¾ç¤ºåŒºåŸŸï¼Œç”¨æˆ·å¯ä»¥è‡ªç”±æ·»åŠ  -->
            </div>
        </div>
        <div id="responseBox">
            <div id="responseTitle">å“åº”çª—å£</div>
            <div id="responseMessage" style="font-size: 14px; color: #333;"></div>
        </div>
    </div>

    <script>
        let headerCounter = 1;
        let rowCount = 1;
        let workbook;

        document.getElementById('fileInput').addEventListener('change', handleFileSelect);

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = new Uint8Array(e.target.result);
                    workbook = XLSX.read(data, { type: 'array' });
                    updateResponseBox(`å·²é€‰æ‹©æ–‡ä»¶ï¼š${file.name}`);
                };
                reader.readAsArrayBuffer(file);
            }
        }

        function addNewHeader() {
            headerCounter++;
            const container2 = document.getElementById('contentPreview2');
            const newTable = document.createElement('table');
            newTable.className = 'resultTable';
            newTable.id = `resultTable2_${headerCounter}`;

            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            const headers = ['åºå·', 'SO', 'Part No', 'Qty', 'åºåˆ—å·', 'æ—¥æœŸ', 'æ“ä½œ'];

            headers.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                headerRow.appendChild(th);
            });

            // æ·»åŠ åˆ é™¤è¡¨å¤´çš„åƒåœ¾æ¡¶å›¾æ ‡
            const deleteHeaderIcon = document.createElement('span');
            deleteHeaderIcon.className = 'deleteHeaderIcon';
            deleteHeaderIcon.innerHTML = 'ğŸ—‘ï¸';
            deleteHeaderIcon.onclick = function() {
                container2.removeChild(newTable);
            };
            headerRow.appendChild(deleteHeaderIcon);

            thead.appendChild(headerRow);
            newTable.appendChild(thead);

            const tbody = document.createElement('tbody');
            newTable.appendChild(tbody);

            container2.appendChild(newTable);
        }

        async function importDataFromGithub() {
            updateResponseBox("æ­£åœ¨å¯¼å…¥æ•°æ®");

            // 1. å¼¹çª—è®©ç”¨æˆ·è¾“å…¥GitHubä»¤ç‰Œ
            const githubToken = prompt("è¯·è¾“å…¥æ‚¨çš„ GitHub ä»¤ç‰Œï¼š");
            if (!githubToken) {
                alert("ä»¤ç‰Œä¸èƒ½ä¸ºç©ºï¼");
                return;
            }

            try {
                // 2. é€šè¿‡GitHub APIè·å–æ•°æ®
                const repoOwner = 'Ricky-cloud-star';  // æ›¿æ¢ä¸ºæ‚¨çš„GitHubç”¨æˆ·å
                const repoName = 'Zenactcod';           // æ›¿æ¢ä¸ºæ‚¨çš„ä»“åº“åç§°
                const filePath = 'data/data.csv';       // æ›¿æ¢ä¸ºæ–‡ä»¶è·¯å¾„ï¼Œä¾‹å¦‚ 'data/data.csv'
                const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;

                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3.raw'
                    }
                });

                if (response.ok) {
                    const csvText = await response.text();
                    populateTable(csvText); // è°ƒç”¨ç°æœ‰çš„å‡½æ•°ä»¥å°†æ•°æ®å¡«å…¥é¡µé¢
                    updateResponseBox('æ•°æ®å¯¼å…¥æˆåŠŸ');
                } else {
                    const responseData = await response.json();
                    alert(`å¯¼å…¥å¤±è´¥ï¼š${responseData.message}`);
                    updateResponseBox('æ•°æ®å¯¼å…¥å¤±è´¥');
                }
            } catch (error) {
                alert(`å¯¼å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼š${error.message}`);
                updateResponseBox('æ•°æ®å¯¼å…¥å¤±è´¥');
            }
        }

        function populateTable(csvText) {
            if (!csvText) {
                alert('å¯¼å…¥çš„æ•°æ®ä¸ºç©ºï¼');
                return;
            }

            const rows = csvText.trim().split("\n");
            let currentTable;
            headerCounter = 1;
            rowCount = 1;

            rows.forEach((rowText, index) => {
                const rowArray = rowText.split(",");
                if (index === 0 || rowArray[0] === 'åºå·') {
                    addNewHeader();
                    currentTable = document.querySelector(`#contentPreview2 table:last-of-type tbody`);
                } else if (currentTable) {
                    const newRow = document.createElement('tr');
                    rowArray.forEach((cellText, i) => {
                        if (i < rowArray.length - 1) { // Skip adding text for the 'æ“ä½œ' column
                            const cell = document.createElement('td');
                            cell.textContent = cellText;
                            newRow.appendChild(cell);
                        }
                    });

                    // é‡æ–°æ·»åŠ æ“ä½œæŒ‰é’®
                    const actionCell = document.createElement('td');
                    const copyButton = document.createElement('button');
                    copyButton.textContent = "ä¸€é”®å¤åˆ¶";
                    copyButton.className = "copyButton";
                    copyButton.onclick = function() {
                        copySerialNumber(newRow.children[4]);
                    };
                    actionCell.appendChild(copyButton);

                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = "åˆ é™¤";
                    deleteButton.className = "deleteButton";
                    deleteButton.onclick = function() {
                        currentTable.removeChild(newRow);
                    };
                    actionCell.appendChild(deleteButton);

                    newRow.appendChild(actionCell);
                    currentTable.appendChild(newRow);
                    rowCount++;
                }
            });

            // ä¸ºå¯¼å…¥çš„ SO åˆ—æ·»åŠ å¤åˆ¶å›¾æ ‡
            addCopyToSOCells();
        }

        function autoAddRows() {
            const partNoInput = document.getElementById('partNoInput').value.trim();
            if (!workbook) {
                updateResponseBox("è¯·å…ˆé€‰æ‹©æ–‡ä»¶ã€‚");
                return;
            }

            if (!partNoInput) {
                updateResponseBox("è¯·è¾“å…¥è®¢å•å·ã€‚");
                return;
            }

            const orderNumbers = partNoInput.split('&').map(order => order.trim());
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const data = XLSX.utils.sheet_to_json(sheet, { header: 1 });
            const headers = data[0];
            const orderNumberIndex = headers.indexOf("Order Number");
            const lnTyIndex = headers.indexOf("Ln Ty");
            const itemNumberIndex = headers.indexOf("2nd Item Number");

            if (orderNumberIndex === -1 || lnTyIndex === -1 || itemNumberIndex === -1) {
                updateResponseBox("Excel æ–‡ä»¶ç¼ºå°‘å¿…è¦çš„åˆ—ã€‚");
                return;
            }

            orderNumbers.forEach(orderNumber => {
                // ä¸ºæ¯ä¸ªè®¢å•å·åˆ›å»ºä¸€ä¸ªæ–°è¡¨å¤´
                addNewHeader();
                const newTableBody = document.querySelector(`#resultTable2_${headerCounter} tbody`);

                let rowCountForOrder = 0;
                data.slice(1).forEach(row => {
                    if (row[orderNumberIndex] == orderNumber && row[lnTyIndex] === "N1") {
                        rowCountForOrder++;

                        const newRow = document.createElement('tr');

                        const serialNumberCell = document.createElement('td');
                        serialNumberCell.textContent = rowCount++;
                        newRow.appendChild(serialNumberCell);

                        const soCell = document.createElement('td');
                        soCell.textContent = orderNumber;
                        newRow.appendChild(soCell);

                        const partNoCell = document.createElement('td');
                        partNoCell.textContent = row[itemNumberIndex];
                        newRow.appendChild(partNoCell);

                        const qtyCell = document.createElement('td');
                        qtyCell.contentEditable = true;
                        newRow.appendChild(qtyCell);

                        const serialCell = document.createElement('td');
                        serialCell.contentEditable = true;
                        newRow.appendChild(serialCell);

                        const dateCell = document.createElement('td');
                        const today = new Date();
                        const formattedDate = today.getFullYear() + '-' + String(today.getMonth() + 1).padStart(2, '0') + '-' + String(today.getDate()).padStart(2, '0');
                        dateCell.textContent = formattedDate;
                        dateCell.contentEditable = true;
                        newRow.appendChild(dateCell);

                        // æ·»åŠ ä¸€é”®å¤åˆ¶æŒ‰é’®å’Œåˆ é™¤æŒ‰é’®
                        const actionCell = document.createElement('td');
                        const copyButton = document.createElement('button');
                        copyButton.textContent = "ä¸€é”®å¤åˆ¶";
                        copyButton.className = "copyButton";
                        copyButton.onclick = function() {
                            copySerialNumber(serialCell);
                        };
                        actionCell.appendChild(copyButton);

                        const deleteButton = document.createElement('button');
                        deleteButton.textContent = "åˆ é™¤";
                        deleteButton.className = "deleteButton";
                        deleteButton.onclick = function() {
                            newTableBody.removeChild(newRow);
                        };
                        actionCell.appendChild(deleteButton);

                        newRow.appendChild(actionCell);

                        newTableBody.appendChild(newRow);
                    }
                });

                if (rowCountForOrder === 0) {
                    updateResponseBox(`æœªæ‰¾åˆ°è®¢å•å· ${orderNumber} çš„ä»»ä½•åŒ¹é…è¡Œã€‚`);
                }
            });

            updateResponseBox("è‡ªåŠ¨æ–°å¢å®Œæˆã€‚");
        }

        // å¤åˆ¶åºåˆ—å·å†…å®¹çš„å‡½æ•°
        function copySerialNumber(serialCell) {
            const serialNumber = serialCell.textContent.trim();
            if (serialNumber === "") {
                updateResponseBox("åºåˆ—å·ä¸ºç©ºï¼Œæ— æ³•å¤åˆ¶ï¼");
                return;
            }

            // åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡æœ¬åŒºåŸŸæ¥å¤åˆ¶å†…å®¹
            const tempInput = document.createElement('textarea');
            tempInput.value = serialNumber;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);

            updateResponseBox("å·²å¤åˆ¶åºåˆ—å·: " + serialNumber);
        }

        async function submitDataToBackend() {
            const tableData = [];
            document.querySelectorAll(`#contentPreview2 table`).forEach(table => {
                const headerData = Array.from(table.querySelectorAll('th')).map(th => th.textContent.trim());
                const tableInfo = { header: headerData, rows: [] };
                table.querySelectorAll('tbody tr').forEach(row => {
                    const rowData = Array.from(row.querySelectorAll('td')).map(td => td.textContent.trim());
                    tableInfo.rows.push(rowData);
                });
                tableData.push(tableInfo);
            });

            // å°†æ•°æ®è½¬æ¢ä¸º CSV æ ¼å¼å­—ç¬¦ä¸²
            let csvContent = "";
            tableData.forEach((table) => {
                csvContent += table.header.join(",") + "\n";
                table.rows.forEach(row => {
                    csvContent += row.join(",") + "\n";
                });
            });

            try {
                const response = await fetch('http://127.0.0.1:5000/api/saveData', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: csvContent
                });

                if (response.ok) {
                    updateResponseBox('æ•°æ®å¯¼å‡ºæˆåŠŸ');
                } else {
                    const responseData = await response.json();
                    updateResponseBox(`æ•°æ®å¯¼å‡ºå¤±è´¥ï¼š${responseData.message}`);
                }
            } catch (error) {
                updateResponseBox(`æ•°æ®å¯¼å‡ºå¤±è´¥ï¼š${error.message}`);
            }
        }

        function updateResponseBox(message) {
            const responseMessage = document.getElementById('responseMessage');
            responseMessage.textContent = message;
        }

        function addCopyToSOCells() {
            document.querySelectorAll(`#contentPreview2 table tbody tr`).forEach(row => {
                const soCell = row.children[1]; // Assuming the SO column is the second column
                if (soCell && !soCell.querySelector('.copyIcon')) {
                    const copyIcon = document.createElement('span');
                    copyIcon.textContent = 'ğŸ“‹';
                    copyIcon.style.cursor = 'pointer';
                    copyIcon.className = 'copyIcon';
                    copyIcon.style.marginLeft = '5px';
                    copyIcon.onclick = function() {
                        copySO(soCell);
                    };
                    soCell.appendChild(copyIcon);
                }
            });
        }

        function copySO(soCell) {
            const soNumber = soCell.childNodes[0] ? soCell.childNodes[0].textContent.trim() : soCell.textContent.trim();
            if (soNumber === "") {
                updateResponseBox("SO å·ä¸ºç©ºï¼Œæ— æ³•å¤åˆ¶ï¼");
                return;
            }

            // åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡æœ¬åŒºåŸŸæ¥å¤åˆ¶å†…å®¹
            const tempInput = document.createElement('textarea');
            tempInput.value = soNumber;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);

            updateResponseBox("å·²å¤åˆ¶ SO å·: " + soNumber);
        }

        function validateData() {
            if (!workbook) {
                updateResponseBox("è¯·å…ˆé€‰æ‹©æ•°æ®éªŒè¯æ–‡ä»¶ã€‚");
                return;
            }

            const validationSheet = workbook.Sheets[workbook.SheetNames[0]];
            if (!validationSheet) {
                updateResponseBox("æœªæ‰¾åˆ°æœ‰æ•ˆçš„å·¥ä½œè¡¨ã€‚");
                return;
            }

            const validationData = XLSX.utils.sheet_to_json(validationSheet, { header: 1 });
            const soIndex = validationData[0].indexOf("Order Reference ID");
            const skuIndex = validationData[0].indexOf("SKU");
            const validationOrders = validationData.slice(1);

            let resultMessage = "æ•°æ®éªŒè¯é€šè¿‡ï¼Œæ‰€æœ‰ SO å’Œ SKU åŒ¹é…ã€‚";
            let allMatch = true;
            let mismatchedPairs = [];

            document.querySelectorAll(`#contentPreview2 table tbody tr`).forEach(row => {
                const soValue = row.children[1].textContent.replace(/ğŸ“‹/g, '').trim();
                const partNoValue = row.children[2].textContent.replace(/ğŸ“‹/g, '').trim();

                const matchingRows = validationOrders.filter(order => order[soIndex].toString().trim() === soValue);
                if (matchingRows.length > 0) {
                    const isMatch = matchingRows.some(order => order[skuIndex].toString().trim() === partNoValue);
                    if (!isMatch) {
                        allMatch = false;
                        mismatchedPairs.push({ so: soValue, partNo: partNoValue, expectedSku: matchingRows.map(row => row[skuIndex]).join(", ") });
                    }
                } else {
                    allMatch = false;
                    mismatchedPairs.push({ so: soValue, partNo: partNoValue, expectedSku: "æœªæ‰¾åˆ°å¯¹åº”çš„ SKU" });
                }
            });

            if (allMatch) {
                updateResponseBox(resultMessage);
            } else {
                resultMessage = "æ•°æ®éªŒè¯å¤±è´¥ï¼Œä»¥ä¸‹ SO å’Œ Part No ä¸åŒ¹é…ï¼š\n";
                mismatchedPairs.forEach(pair => {
                    resultMessage += `SO: ${pair.so}, é¡µé¢ Part No: ${pair.partNo}, æœŸæœ› SKU: ${pair.expectedSku}\n`;
                });
                updateResponseBox(resultMessage);
            }
        }

    </script>
</body>
</html>
